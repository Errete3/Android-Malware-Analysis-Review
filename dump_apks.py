import os
from apk_tools import ApkExtractor

mal_apks_dir= '/Users/jaime/Desktop/APKS/MALWARE/'
ook_apks_dir = '/Users/jaime/Desktop/APKS/BENIGN/'
mal_apks_paths = [os.path.join(mal_apks_dir,apk) for apk in os.listdir(mal_apks_dir)]
ook_apks_paths = [os.path.join(ook_apks_dir,apk) for apk in os.listdir(ook_apks_dir)]

manifest_features = set()

mal_apks_data = []
for apk_path in mal_apks_paths:
    data = ApkExtractor(apk_path)
    manifest_data = data.get_manifest_data()
    manifest_data = manifest_data['permissions'] + manifest_data['intent_filter_action'] + manifest_data['intent_filter_category']
    manifest_features.update(manifest_data)
    mal_apks_data.append(manifest_data)

ook_apks_data = []
for apk_path in ook_apks_paths:
    data = ApkExtractor(apk_path)
    manifest_data = data.get_manifest_data()
    manifest_data = manifest_data['permissions'] + manifest_data['intent_filter_action'] + manifest_data['intent_filter_category']
    manifest_features.update(manifest_data)
    ook_apks_data.append(manifest_data)

mal_apks_features = []
for apk_data in mal_apks_data:
    features = []
    for feature in manifest_features:
        if feature in apk_data:
            features.append(1)
        else:
            features.append(0)
    mal_apks_features.append(features)

ook_apks_features = []
for apk_data in ook_apks_data:
    features = []
    for feature in manifest_features:
        if feature in apk_data:
            features.append(1)
        else:
            features.append(0)
    ook_apks_features.append(features)

print(manifest_features)
mal_apks_labels = [1] * len(mal_apks_data)
ook_apks_labels = [0] * len(ook_apks_data)